{
    "version": "https://jsonfeed.org/version/1",
    "title": "少女的Blog • All posts by \"android\" tag",
    "description": "",
    "home_page_url": "https://onaniishoujo.github.io",
    "items": [
        {
            "id": "https://onaniishoujo.github.io/2024/04/06/Ubuntu%E9%85%8D%E7%BD%AEAndroid-SDK%E5%B9%B6%E4%BD%BF%E7%94%A8Cordova/",
            "url": "https://onaniishoujo.github.io/2024/04/06/Ubuntu%E9%85%8D%E7%BD%AEAndroid-SDK%E5%B9%B6%E4%BD%BF%E7%94%A8Cordova/",
            "title": "Ubuntu配置Android SDK并使用Cordova",
            "date_published": "2024-04-06T09:48:53.000Z",
            "content_html": "<p>在 Ubuntu 20.04.6 LTS 上配置 Android SDK，并使用 Cordova 打包 Android App</p>\n<p>这里使用 Github 的 Codespace</p>\n<p><s>用 Goorm IDE 发现存储空间不够，在 Codespace 上又重装了一遍</s></p>\n<h3 id=\"配置cordova\"><a class=\"anchor\" href=\"#配置cordova\">#</a> 配置 Cordova</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> update</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">npm</span> <span class=\"token function\">install</span> cordova <span class=\"token parameter variable\">-g</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">npm</span> update cordova <span class=\"token parameter variable\">-g</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>cordova create <span class=\"token operator\">&lt;</span>文件夹名<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>包名<span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>软件名<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">cd</span> <span class=\"token operator\">&lt;</span>文件夹名<span class=\"token operator\">></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>cordova platform <span class=\"token function\">add</span> android <span class=\"token parameter variable\">--save</span></pre></td></tr></table></figure><p>预览命令：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cordova serve</pre></td></tr></table></figure><h3 id=\"配置jdk\"><a class=\"anchor\" href=\"#配置jdk\">#</a> 配置 JDK</h3>\n<p>Codespace 自带 JDK 21，但是好像有 bug，JDK 17 能正常使用</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> openjdk-17-jdk</pre></td></tr></table></figure><p>安装 JDK 17 后需要设置 JDK 的环境变量，不然就是用的 JDK 21 的环境变量</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">JAVA_HOME</span><span class=\"token operator\">=</span>/usr/local/sdkman/candidates/java/17.0.10-ms  <span class=\"token comment\">#jdk17 的位置</span></pre></td></tr></table></figure><h3 id=\"配置android-sdk\"><a class=\"anchor\" href=\"#配置android-sdk\">#</a> 配置 Android SDK</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">wget</span> https://dl.google.com/android/repository/commandlinetools-linux-11076708_latest.zip</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">unzip</span> commandlinetools-linux-11076708_latest.zip</pre></td></tr></table></figure><p>添加环境变量：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">vim</span> ~/.bashrc</pre></td></tr></table></figure><p>在 <code>.bashrc</code>  中添加下面三行：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">ANDROID_SDK_ROOT</span><span class=\"token operator\">=</span>/path/to/your/sdk  <span class=\"token comment\">#你的 sdk 位置</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">ANDROID_HOME</span><span class=\"token operator\">=</span><span class=\"token variable\">$ANDROID_SDK_ROOT</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token environment constant\">$PATH</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$ANDROID_SDK_ROOT</span>/bin</pre></td></tr></table></figure><p>重新打开终端，输入</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sdkmanager <span class=\"token string\">\"platform-tools\"</span> <span class=\"token string\">\"platforms;android-33\"</span> <span class=\"token string\">\"build-tools;33.0.2\"</span> <span class=\"token parameter variable\">--sdk_root</span><span class=\"token operator\">=</span><span class=\"token variable\">$ANDROID_SDK_ROOT</span></pre></td></tr></table></figure><h3 id=\"打包\"><a class=\"anchor\" href=\"#打包\">#</a> 打包</h3>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cordova build android</pre></td></tr></table></figure><h3 id=\"错误及解决方式\"><a class=\"anchor\" href=\"#错误及解决方式\">#</a> 错误及解决方式</h3>\n<p><code>Error: LinkageError occurred while loading main class com.android.sdklib.tool.sdkmanager.SdkManagerCli        java.lang.UnsupportedClassVersionError: com/android/sdklib/tool/sdkmanager/SdkManagerCli has been compiled by a more recent version of the Java Runtime (class file version 61.0), this version of the Java Runtime only recognizes class file versions up to 55.0</code></p>\n<p>解决方法：</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>sdkmanager <span class=\"token string\">\"build-tools;33.0.2\"</span> <span class=\"token parameter variable\">--sdk_root</span><span class=\"token operator\">=</span><span class=\"token variable\">$ANDROID_SDK_ROOT</span></pre></td></tr></table></figure><p><code>Could not open settings generic class cache for settings file '/workspaces/android/app/platforms/android/settings.gradle' (/home/codespace/.gradle/caches/7.6/scripts/dqjrgsw17c62wbpoagod92e1e). &gt; BUG! exception in phase 'semantic analysis' in source unit '_BuildScript_' Unsupported class file major version 65</code></p>\n<p>解决方法：</p>\n<p>将 <code>$JAVA_HOME</code>  设置为 JDK 17 的目录</p>\n<p><code>Execution failed for task ':app:mergeLibDexDebug'. &gt; Could not resolve all files for configuration ':app:debugRuntimeClasspath'.   &gt; Failed to transform debug (project :CordovaLib) to match attributes &#123;artifactType=android-dex, asm-transformed-variant=NONE, com.android.build.api.attributes.AgpVersionAttr=7.4.2, com.android.build.api.attributes.BuildTypeAttr=debug, com.android.build.gradle.internal.attributes.VariantAttr=debug, dexing-enable-desugaring=true, dexing-enable-jacoco-instrumentation=false, dexing-is-debuggable=true, dexing-min-sdk=24, org.gradle.libraryelements=classes, org.gradle.usage=java-runtime&#125;.      &gt; Execution failed for DexingNoClasspathTransform: /workspaces/android/app/platforms/android/CordovaLib/build/intermediates/runtime_library_classes_dir/debug.         &gt; Error while dexing.</code></p>\n<p>解决办法：</p>\n<p><s>解决上面两个就没这个了</s></p>\n",
            "tags": [
                "Github",
                "Android",
                "Linux"
            ]
        }
    ]
}