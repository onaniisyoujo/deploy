{
    "version": "https://jsonfeed.org/version/1",
    "title": "少女的Blog • All posts by \"github\" tag",
    "description": "",
    "home_page_url": "https://onaniishoujo.github.io",
    "items": [
        {
            "id": "https://onaniishoujo.github.io/2024/01/21/%E4%BD%BF%E7%94%A8Github-Actions%E8%87%AA%E5%8A%A8%E5%88%87%E6%8D%A2%E7%BD%91%E7%AB%99%E4%B8%BB%E9%A2%98/",
            "url": "https://onaniishoujo.github.io/2024/01/21/%E4%BD%BF%E7%94%A8Github-Actions%E8%87%AA%E5%8A%A8%E5%88%87%E6%8D%A2%E7%BD%91%E7%AB%99%E4%B8%BB%E9%A2%98/",
            "title": "使用Github Actions自动切换网站主题",
            "date_published": "2024-01-21T12:43:54.000Z",
            "content_html": "<blockquote>\n<p>现在网站用了六套主题，可喜可贺</p>\n</blockquote>\n<p>使用 <code>Github Actions</code>  实现每天自动切换网站的主题</p>\n<p>比如周一、三、五、七使用 <code>theme-A</code> ，二、四、六使用 <code>theme-B</code></p>\n<p>当然也可以添加 <code>theme-C</code> 、 <code>theme-D</code> ...</p>\n<ol>\n<li>\n<p>在 <code>用户名.github.io</code>  仓库中有两个文件夹 <code>theme-A/</code>  和 <code>theme-B/</code> ，用于存放两套主题的静态文件</p>\n</li>\n<li>\n<p>在 GitHub 的 Settings -&gt; Developer Settings -&gt; Personal access tokens -&gt; Tokens (classic) (<a href=\"https://github.com/settings/tokens/new\">链接</a>) 生成一个 token，填写 Note，勾选 <code>repo</code>  和 <code>workflow</code>  然后生成</p>\n<p><img loading=\"lazy\" data-src=\"/assets/20240121/token.png\" alt=\"token\" /></p>\n</li>\n<li>\n<p>在仓库的 Settings -&gt; Secrets and variables -&gt; Actions 添加刚才的 token</p>\n<p><img loading=\"lazy\" data-src=\"/assets/20240121/secret.png\" alt=\"secret\" /></p>\n</li>\n<li>\n<p>在 GitHub 仓库中新建 <code>.github/workflows</code> ，新建一个 <code>.yaml</code>  文件，文件名随意；可以先点 <code>Run workflow</code>  把静态文件部署到 <code>gh-pages</code>  分支</p>\n</li>\n</ol>\n<figure class=\"highlight yaml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Update Blog</pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token key atrule\">on</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">workflow_dispatch</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>  <span class=\"token key atrule\">schedule</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">cron</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"0 2 * * *\"</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token key atrule\">jobs</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>  <span class=\"token key atrule\">update</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token key atrule\">runs-on</span><span class=\"token punctuation\">:</span> ubuntu<span class=\"token punctuation\">-</span>latest</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token key atrule\">steps</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Checkout code</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> actions/checkout@v4</pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Determine Deployment Directory</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> determine_directory</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\"></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>          day_of_week=$(date +'%u')</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>          if [ $((day_of_week % 2)) -eq 0 ]; then</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>          echo \"::set-output name=directory::theme-B/\"</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            else</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>          echo \"::set-output name=directory::theme-A/\"</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>          fi</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>          </pre></td></tr><tr><td data-num=\"25\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Get Current Time</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token key atrule\">id</span><span class=\"token punctuation\">:</span> current_time</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> echo \"<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>set<span class=\"token punctuation\">-</span>output name=time<span class=\"token punctuation\">:</span><span class=\"token punctuation\">:</span>$(date +'%Y<span class=\"token punctuation\">-</span>%m<span class=\"token punctuation\">-</span>%d %H<span class=\"token punctuation\">:</span>%M<span class=\"token punctuation\">:</span>%S')\"</pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> Deploy</pre></td></tr><tr><td data-num=\"30\"></td><td><pre>        <span class=\"token key atrule\">uses</span><span class=\"token punctuation\">:</span> peaceiris/actions<span class=\"token punctuation\">-</span>gh<span class=\"token punctuation\">-</span>pages@v3.9.3 <span class=\"token comment\"># 使用部署到 GitHub pages 的 action</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>        <span class=\"token key atrule\">with</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>          <span class=\"token key atrule\">publish_dir</span><span class=\"token punctuation\">:</span> $&lt;<span class=\"token tag\">!--swig</span>￼0<span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span><span class=\"token punctuation\">></span><span class=\"token scalar string\"> </pre></td></tr><tr><td data-num=\"33\"></td><td><pre>          github_token: $ # secret 名</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>          user_name: $</pre></td></tr><tr><td data-num=\"35\"></td><td><pre>          user_email: $</pre></td></tr><tr><td data-num=\"36\"></td><td><pre>          commit_message: \"Automated Deployment at $\" # 在 commit message 中添加当前时间</span></pre></td></tr></table></figure><ol start=\"5\">\n<li>在仓库的 Settings -&gt; Pages 设置 <code>Build and deployment</code>  的 <code>Source</code>  为 <code>Deploy from a branch</code> ，选择 <code>gh-pages</code>  分支，此时 GitHub Pages 将开始部署</li>\n</ol>\n<p><s>总之就挺神经病的</s></p>\n<p><s>写的方法我自己都看不懂</s></p>\n<p><s>感谢 ChatGPT 提供的 GitHub Actions 的源码</s></p>\n",
            "tags": [
                "资源",
                "Github"
            ]
        }
    ]
}